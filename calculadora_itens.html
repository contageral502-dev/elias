<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Calculadora de Itens — Final</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f2f5;
    padding: 20px;
  }
  .container {
    max-width: 980px;
    margin: 0 auto;
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 6px 18px rgba(16,24,40,0.06);
  }
  h1 {
    font-size: 22px;
    margin-bottom: 10px;
  }
  label {
    display: block;
    margin-top: 12px;
    font-weight: 600;
  }
  select, input {
    padding: 8px;
    width: 100%;
    margin-top: 6px;
    border-radius: 6px;
    border: 1px solid #d0d7de;
  }
  .row {
    display: flex;
    gap: 12px;
    margin-top: 12px;
    flex-wrap: wrap;
  }
  .col {
    flex: 1;
    min-width: 200px;
  }
  button {
    padding: 10px 14px;
    margin-top: 10px;
    border: none;
    background: #1766ff;
    color: #fff;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
  }
  button:hover {
    background: #0f4ccf;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 14px;
  }
  th, td {
    border-bottom: 1px solid #e9eef5;
    padding: 8px 10px;
    text-align: left;
  }
  th {
    background: #fafcff;
    color: #334155;
    font-weight: 700;
  }
  .muted {
    color: #667085;
    font-size: 13px;
    margin-top: 8px;
  }
  .summary {
    background: #fbfdff;
    border: 1px solid #e6eefc;
    padding: 12px;
    border-radius: 8px;
    margin-top: 12px;
  }
  .summary div {
    display: flex;
    justify-content: space-between;
    padding: 6px 0;
  }
  .actions {
    display: flex;
    gap: 8px;
    margin-top: 10px;
    flex-wrap: wrap;
  }
  .copy-btn {
    padding: 8px 10px;
    border-radius: 6px;
    border: 1px solid #d0d7de;
    background: white;
    cursor: pointer;
  }
  .copy-btn:hover {
    background: #f3f4f6;
  }
</style>
</head>
<body>
<div class="container">
  <h1>Calculadora de Itens — Final</h1>

  <label for="itemSelect">Item</label>
  <select id="itemSelect"></select>

  <div class="row">
    <div class="col">
      <label for="qtyInput">Quantidade</label>
      <input id="qtyInput" type="number" min="1" value="1" />
    </div>
    <div style="width:150px">
      <label>&nbsp;</label>
      <button id="calcBtn">Calcular</button>
    </div>
  </div>

  <div class="actions">
    <button class="copy-btn" id="copyBtn">Copiar totais</button>
    <button class="copy-btn" id="csvBtn">Exportar CSV</button>
  </div>

  <div class="summary" id="summaryBox" style="display:none; margin-top:16px;">
    <div><strong>Item</strong><span id="sumItem">—</span></div>
    <div><span class="muted">Categoria</span><span id="sumCategory">—</span></div>
    <div><span class="muted">Preço S/P (unid)</span><strong id="sumPriceSP">R$ 0</strong></div>
    <div><span class="muted">Preço S/P (total)</span><strong id="sumPriceSPTotal">R$ 0</strong></div>
    <div><span class="muted">Preço C/P (unid)</span><strong id="sumPriceCP">R$ 0</strong></div>
    <div><span class="muted">Preço C/P (total)</span><strong id="sumPriceCPTotal">R$ 0</strong></div>
    <div><span class="muted">Peso (unid)</span><strong id="sumWeight">0 Kg</strong></div>
    <div><span class="muted">Peso (total)</span><strong id="sumWeightTotal">0 Kg</strong></div>
    <div id="valorObtSection" style="display:none"><span class="muted">Valor obtido (unid)</span><strong id="sumValorObt">R$ 0</strong></div>
    <div id="valorObtTotalSection" style="display:none"><span class="muted">Valor obtido (total)</span><strong id="sumValorObtTotal">R$ 0</strong></div>
    <div id="outputQtySection" style="display:none"><span class="muted">Quantidade produzida (total)</span><strong id="sumOutputQty">0</strong></div>
  </div>

  <h3 style="margin-top:18px">Materiais necessários</h3>
  <table>
    <thead>
      <tr><th>Material / Propriedade</th><th>Por 1</th><th>Total</th></tr>
    </thead>
    <tbody id="materialsBody"></tbody>
  </table>

</div>

<script>
// ==== Dados dos Itens ====
const ITEMS = [
  {category:"Rifles", item:"G36C", Price_SP:140000, Price_CP:120000, WeightKg:8.75, Borracha:425, Plastico:425, Vidro:305, Pecas_de_Armas:10, Aluminio:300, Cobre:425, Mola_de_Metal:3, Corpo:1},
  {category:"Rifles", item:"AK-74N", Price_SP:110000, Price_CP:100000, WeightKg:7.75, Borracha:425, Plastico:425, Vidro:305, Pecas_de_Armas:10, Aluminio:300, Cobre:425, Mola_de_Metal:3, Corpo:1},
  {category:"Rifles", item:"AK-102", Price_SP:110000, Price_CP:95000, WeightKg:7.75, Borracha:400, Plastico:400, Vidro:275, Pecas_de_Armas:10, Aluminio:345, Cobre:425, Mola_de_Metal:3, Corpo:1},
  {category:"Rifles", item:"Heavy Sniper MK", Price_SP:4000000, Price_CP:4000000, WeightKg:4.25, Borracha:400, Plastico:400, Vidro:275, Pecas_de_Armas:10, Aluminio:345, Cobre:425, Mola_de_Metal:3, Corpo:1},
  {category:"Submetralhadoras", item:"Uzi", Price_SP:90000, Price_CP:75000, WeightKg:4.25, Borracha:235, Plastico:275, Vidro:225, Pecas_de_Armas:5, Aluminio:175, Cobre:175, Mola_de_Metal:2, Corpo:1},
  {category:"Submetralhadoras", item:"MAC-10", Price_SP:90000, Price_CP:75000, WeightKg:5.25, Borracha:235, Plastico:275, Vidro:225, Pecas_de_Armas:5, Aluminio:175, Cobre:175, Mola_de_Metal:2, Corpo:1},
  {category:"Submetralhadoras", item:"F2000", Price_SP:150000, Price_CP:120000, WeightKg:5.75, Borracha:305, Plastico:305, Vidro:375, Pecas_de_Armas:5, Aluminio:225, Cobre:225, Mola_de_Metal:2, Corpo:1},
  {category:"Submetralhadoras", item:"Glock Rajada", Price_SP:90000, Price_CP:75000, WeightKg:2.75, Borracha:145, Plastico:155, Vidro:145, Pecas_de_Armas:5, Aluminio:100, Cobre:100, Mola_de_Metal:2, Corpo:1},
  {category:"Pistolas", item:"Tourus TH1911", Price_SP:50000, Price_CP:35000, WeightKg:3.75, Borracha:155, Plastico:165, Vidro:155, Pecas_de_Armas:5, Aluminio:100, Cobre:100, Mola_de_Metal:1, Corpo:1},
  {category:"Pistolas", item:"M45A1", Price_SP:50000, Price_CP:35000, WeightKg:2.75, Borracha:155, Plastico:175, Vidro:155, Pecas_de_Armas:5, Aluminio:100, Cobre:100, Mola_de_Metal:1, Corpo:1},
  {category:"Munições", item:"Munição de Sniper", Price_SP:25, Price_CP:25, WeightKg:0.025, Aluminio:18, Cobre:12, Frasco_de_Pólvora:1},
  // Metadona com quantidade produzida de 10 unidades
  {category:"Diversos", item:"Seringa de Metadona", Price_SP:700, Price_CP:600, WeightKg:0.05, Acido_Sulfurico:5, Alcool:5, Analgesicos:2, OutputQty:10},
  {category:"Diversos", item:"Lavagem de Dinheiro", Price_SP:5500, Price_CP:6500, WeightKg:0, Dinheiro_Sujo:10000, Agua_Destilada:6, Cloro:6, ValorObtidoPor10000:9000}
];

const LABELS = {
  Price_SP: "Preço S/P (R$)",
  Price_CP: "Preço C/P (R$)",
  WeightKg: "Peso (Kg)",
  Borracha: "Borracha",
  Plastico: "Plástico",
  Vidro: "Vidro",
  Pecas_de_Armas: "Peças de Armas",
  Aluminio: "Alumínio",
  Cobre: "Cobre",
  Mola_de_Metal: "Mola de Metal",
  Corpo: "Corpo (Rifle/Sub/Pistola)",
  Frasco_de_Pólvora: "Frasco de Pólvora",
  Acido_Sulfurico: "Ácido Sulfúrico",
  Alcool: "Álcool",
  Analgesicos: "Analgésicos",
  Dinheiro_Sujo: "Dinheiro Sujo (R$)",
  Agua_Destilada: "Água Destilada",
  Cloro: "Cloro"
};

const itemSelect = document.getElementById('itemSelect');
ITEMS.forEach(it => {
  const opt = document.createElement('option');
  opt.value = it.item;
  opt.textContent = it.item;
  itemSelect.appendChild(opt);
});

const qtyInput = document.getElementById('qtyInput');
const calcBtn = document.getElementById('calcBtn');
const materialsBody = document.getElementById('materialsBody');
const summaryBox = document.getElementById('summaryBox');

function formatMoney(n){ return "R$ " + Number(n).toLocaleString('pt-BR', {minimumFractionDigits:2, maximumFractionDigits:2}); }
function formatWeight(n){ return Number(n).toFixed(3) + " Kg"; }

function calcAndRender(){
  const name = itemSelect.value;
  const qty = Math.max(1, parseInt(qtyInput.value) || 1);
  const item = ITEMS.find(i => i.item === name);
  if(!item){ summaryBox.style.display = 'none'; materialsBody.innerHTML = ''; return; }

  // Calcular quantidade total produzida (para itens como metadona)
  const outputMultiplier = item.OutputQty || 1;
  const totalProduced = qty * outputMultiplier;

  // === Resumo ===
  summaryBox.style.display = '';
  document.getElementById('sumItem').textContent = item.item;
  document.getElementById('sumCategory').textContent = item.category || '—';
  const sp = Number(item.Price_SP || 0);
  const cp = Number(item.Price_CP || sp || 0);
  document.getElementById('sumPriceSP').textContent = formatMoney(sp);
  document.getElementById('sumPriceSPTotal').textContent = formatMoney(sp * qty);
  document.getElementById('sumPriceCP').textContent = formatMoney(cp);
  document.getElementById('sumPriceCPTotal').textContent = formatMoney(cp * qty);
  document.getElementById('sumWeight').textContent = formatWeight(Number(item.WeightKg || 0));
  document.getElementById('sumWeightTotal').textContent = formatWeight(Number(item.WeightKg || 0) * totalProduced);

  // Valor obtido
  if(item.ValorObtidoPor10000){
    const perUnit = Number(item.ValorObtidoPor10000);
    document.getElementById('sumValorObt').textContent = formatMoney(perUnit);
    document.getElementById('sumValorObtTotal').textContent = formatMoney(perUnit * qty);
    document.getElementById('valorObtSection').style.display = '';
    document.getElementById('valorObtTotalSection').style.display = '';
  } else {
    document.getElementById('valorObtSection').style.display = 'none';
    document.getElementById('valorObtTotalSection').style.display = 'none';
  }

  // Quantidade produzida
  if(item.OutputQty){
    document.getElementById('sumOutputQty').textContent = totalProduced;
    document.getElementById('outputQtySection').style.display = '';
  } else {
    document.getElementById('outputQtySection').style.display = 'none';
  }

  // === Materiais ===
  materialsBody.innerHTML = '';
  const order = ["Price_SP","Price_CP","WeightKg","Borracha","Plastico","Vidro","Pecas_de_Armas","Aluminio","Cobre","Mola_de_Metal","Corpo","Frasco_de_Pólvora","Acido_Sulfurico","Alcool","Analgesicos","Dinheiro_Sujo","Agua_Destilada","Cloro"];
  order.forEach(k => {
    const val = Number(item[k] || 0);
    if(val > 0){
      const tr = document.createElement('tr');
      const nameCell = document.createElement('td');
      nameCell.textContent = LABELS[k] || k;
      const perCell = document.createElement('td');
      const totalCell = document.createElement('td');

      if(k === 'Price_SP' || k === 'Price_CP' || k === 'Dinheiro_Sujo'){
        perCell.textContent = formatMoney(val);
        totalCell.textContent = formatMoney(val * qty);
      } else if(k === 'WeightKg'){
        perCell.textContent = formatWeight(val);
        totalCell.textContent = formatWeight(val * totalProduced);
      } else {
        perCell.textContent = String(val);
        totalCell.textContent = String(val * qty);
      }

      tr.appendChild(nameCell);
      tr.appendChild(perCell);
      tr.appendChild(totalCell);
      materialsBody.appendChild(tr);
    }
  });
}

// Eventos
calcBtn.addEventListener('click', calcAndRender);
itemSelect.addEventListener('change', calcAndRender);
qtyInput.addEventListener('keyup', (e)=>{ if(e.key==='Enter') calcAndRender(); });

// Cálculo inicial
calcAndRender();
</script>
</body>
</html>
